import{s as f}from"./service-P8kc4j81.js";import{_ as p,G as _,r as v,o as i,c as k,w as c,a as h,t as a,b as o,F as m,d,n as b,e as y}from"./index-CampbdA2.js";const g={name:"HomeAssistant",mixins:[f],props:{item:Object},components:{Generic:_},data:()=>({status:"",version:"",entities:0,location_name:"",separator:" ",items:["name","version"]}),computed:{headers:function(){return{Authorization:`Bearer ${this.item.apikey}`,"Content-Type":"application/json"}},details:function(){const e=[],t=this.items,s=this.separator;for(const r in t){const n=t[r];switch(n){case"version":e.push(`v${this.version}`);break;case"name":e.push(`${this.location_name}`);break;case"entities":e.push(`${this.entities} entities`);break;default:e.push(`undefined key ${n} `)}}return e.join(s)}},created(){this.fetchServerStatus().then(()=>{!this.item.subtitle&&this.status!=="dead"&&(this.item.items&&(this.items=this.item.items),this.item.separator&&(this.separator=this.item.separator),this.fetchServerStats())})},methods:{fetchServerStatus:async function(){const e=this.headers;return this.fetch("/api/",{headers:e}).then(t=>{if(t&&t.message)this.status="running";else throw new Error}).catch(t=>{console.log(t),this.status="dead"})},fetchServerStats:async function(){const e=this.headers;this.fetch("/api/config",{headers:e}).then(t=>{if(t)t.version&&(this.version=t.version),t.location_name&&(this.location_name=t.location_name);else throw new Error}).catch(t=>{console.log(t),this.status="dead"}),this.fetch("/api/states",{headers:e}).then(t=>{if(t)this.entities=t.length;else throw new Error}).catch(t=>{console.log(t),this.status="dead"})}}},w={class:"title is-4"},S={class:"subtitle is-6"};function B(e,t,s,r,n,l){const u=v("Generic");return i(),k(u,{item:s.item},{content:c(()=>[h("p",w,a(s.item.name),1),h("p",S,[s.item.subtitle?(i(),o(m,{key:0},[d(a(s.item.subtitle),1)],64)):(i(),o(m,{key:1},[d(a(l.details),1)],64))])]),indicator:c(()=>[e.status?(i(),o("div",{key:0,class:b(["status",e.status])},a(e.status),3)):y("",!0)]),_:1},8,["item"])}const G=p(g,[["render",B],["__scopeId","data-v-bde8b6d3"]]);export{G as default};
